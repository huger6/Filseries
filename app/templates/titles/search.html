{% extends "base.html" %}
<!-- Title -->
{% block title %}
- Results for "{{ query }}"
{% endblock %}

<!-- CSS -->
{% block css %}
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/search.css')}}">
{% endblock %}

<!-- Scripts -->
{% block head_scripts %}
{% endblock %}

{% block main %}
<div class="search-page">
    <div class="search-header">
        <h1 class="search-title">
            <i class="bi bi-search"></i>
            Search Results
        </h1>
        <p class="search-query">
            {% if results and results|length > 0 %}
                Found <span class="result-count">{{ results|length }}</span> results for "<span class="query-text">{{ query }}</span>"
            {% else %}
                No results found for "<span class="query-text">{{ query }}</span>"
            {% endif %}
        </p>
    </div>
    
    {% if results and results|length > 0 %}
    <div id="search-results" data-results='{{ (results | tojson | safe) if results else "[]" }}'>
        <div class="results-grid">
            {% for result in results %}
            <a class="result-card" id="title-{{ result.id }}" href="{{url_for('titles.title', media_type=result.media_type, id=result.id)}}">
                <div class="card-poster-container">
                    <div class="card-poster">
                        <img src="{{ 'https://image.tmdb.org/t/p/w300' ~ result.poster_path if result.poster_path else url_for('static', filename='img/defaultPoster.svg') }}" alt="{{ result.title }}" loading="lazy" class="poster-img{% if not result.poster_path %} default-poster{% endif %}">
                    </div>
                    <div class="card-badges">
                        <span class="media-type-badge">{{ 'Movie' if result.media_type == 'movie' else 'Serie' }}</span>
                        {% if result.seen %}
                        <span class="status-badge watched"><i class="bi bi-check-circle-fill"></i></span>
                        {% elif result.in_watchlist %}
                        <span class="status-badge watchlist"><i class="bi bi-bookmark-fill"></i></span>
                        {% endif %}
                    </div>
                </div>
                <div class="card-content">
                    <h4 class="card-title">{{ result.title }}</h4>
                    <div class="card-meta">
                        <span class="release-date">
                            <i class="bi bi-calendar3"></i>
                            {{ result.release_date if result.release_date else "N/A" }}
                        </span>
                        <span class="rating">
                            <i class="bi bi-star-fill"></i>
                            {{ "%.1f"|format(result.vote_average) if result.vote_average else "N/A" }}
                        </span>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="no-results">
        <i class="bi bi-film"></i>
        <h3>No titles found</h3>
        <p>Try searching with different keywords or check your spelling.</p>
        <a href="{{url_for('main.home')}}" class="btn-home">
            <i class="bi bi-house"></i> Back to Home
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}

<!-- Scripts -->
{% block js %}
    <script src="{{url_for('static', filename='js/search.js')}}"></script>
{% endblock %}